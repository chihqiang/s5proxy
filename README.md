# s5proxy
`s5proxy` 是一个轻量级且高性能的 SOCKS5 代理服务器，支持：

- 用户名密码认证（SOCKS5 标准认证方式）
- 目标地址白名单（限制连接目标，提高安全性）
- 最大连接数限制（防止资源过载）
- 双向流量统计，实时监控上传下载流量
- 支持优雅关闭，方便集成和运维

## 主要功能

| 功能点             | 描述                                             |
| ------------------ | ------------------------------------------------ |
| SOCKS5 支持        | 完整实现 SOCKS5 协议，支持标准认证与连接转发     |
| 用户名密码认证     | 仅允许通过验证的用户名密码连接，提高访问安全     |
| 目标 IP/域名白名单 | 只允许连接白名单中的目标 IP 或域名               |
| 最大连接数限制     | 并发连接数量控制，防止代理服务被压垮             |
| 流量统计           | 自动统计每个连接的上传和下载字节数，并在日志输出 |
| 优雅关闭           | 支持关闭监听及等待所有连接完成，防止数据丢失     |

## 配置文件示例 (config.yaml)

```
# 监听地址
listen: ":1080"

# 最大同时连接数
max_conns: 100

# 用户名密码认证列表
users:
  testuser: testpass

# 允许的客户端 IP/域名 白名单（为空表示不限制）
allowed_hosts:
  - "127.0.0.1"
  - "::1"
  - "*.baidu.com"
```

## 快速启动

~~~
git clone https://github.com/chihqiang/s5proxy.git
make buld
./s5proxy -config config.yaml
~~~

## 使用示例

```
curl -x socks5h://testuser:testpass@127.0.0.1:1080 https://www.baidu.com
```

## 关闭代理

使用 `Ctrl+C` 或发送 `SIGINT` 信号，代理将优雅关闭，等待所有连接结束。
